<html> 
<head>
  <title>OG Tutorial App</title>
<!-- The Scripts -->
<script src="js/lib/jquery-1.7.2.min.js"></script>
<script src="js/jqm-config.js"></script>
<script src="js/lib/jquery.mobile-1.1.1.min.js"></script>
<script src="js/lib/underscore-min.js"></script>
<script src="js/lib/backbone-min.js"></script>
<script src="js/lib/backbone-relational.js"></script>
<script src="js/lib/FacebookUser.js"></script>

</head>
<body>
  <div id="fb-root"></div>
  <script>
    window.fbAsyncInit = function() {
    	
      console.info('FB jssdk loaded');
      FB.init({
        appId      : '345218642220354', // App ID
        status     : true, // check login status
        cookie     : true, // enable cookies to allow the server to access the session
        xfbml      : true  // parse XFBML
      });
  
    user = new FacebookUser();

    user.on('facebook:unauthorized', function(model, response) {
      console.info('facebook:unauthorized');
      $('#loginstatus').text(response.status);
    });

    user.on('facebook:connected', function(model, response) {
      console.info('facebook:connected');
      $('#loginstatus').text(response.status);
      $('#login').attr('disabled', true);
      $('#logout').attr('disabled', false);
    });

    user.on('facebook:disconnected', function(model, response) {
      console.info('facebook:disconnected');
      $('#loginstatus').text(response.status);
      $('#login').attr('disabled', false);
      $('#logout').attr('disabled', true)
    });

    user.on('change', function() {
      console.info('change');

      var table = $('.table tbody').empty();
      _(user.attributes).each(function(value, attribute){
        if (typeof value !== 'string') return;
        var tr = $(document.createElement('tr'));
        var attr = $(document.createElement('td')).text(attribute).appendTo(tr);
        var val = $(document.createElement('td')).text(value).appendTo(tr);
        tr.append(attr).append(val).appendTo(table);
      }, this);

      $('#user_picture').show().attr('src', user.get('pictures').square);
    });

    $('#login').click(function(){ user.login() });
    $('#logout').click(function(){ user.logout() });

    user.updateLoginStatus();
  };
  
    // Load the SDK Asynchronously
    (function(d){
      var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
      js = d.createElement('script'); js.id = id; js.async = true;
      js.src = "//connect.facebook.net/en_US/all.js";
      d.getElementsByTagName('head')[0].appendChild(js);
    }(document));
  </script>

            <button id="login" class="btn btn-large">Login</button>
            <button id="logout" class="btn btn-large" disabled="disabled">Logout</button>


        <table class="table">
<thead><tr>
<th>Attribute</th>
              <th>Value</th>
            </tr></thead>
<tbody></tbody>
</table>

</body>
</html>